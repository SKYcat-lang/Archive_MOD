on_actions = {
	on_startup = {
		effect = {
			every_country = {
				limit = {
					Kivotos_tag = yes
					has_idea = BA_exiles_of_the_future
				}
				add_timed_idea = {
					idea = BA_railway_gauge_issue
					days = 2080
				}
				random_owned_state = {
					damage_building = {
						type = rail_way
						damage = 1.2
					}
				}
				random_owned_state = {
					damage_building = {
						type = rail_way
						damage = 0.6
					}
				}
				random_owned_state = {
					damage_building = {
						type = rail_way
						damage = 0.3
					}
				}
			}
			every_country = {
				limit = {
					Kivotos_tag = yes
					NOT = {
						tag = GEI
						tag = RE1
						tag = RE2
						tag = RE3
						tag = RE4
					}
				}
				add_ideas = BA_highlander_academy_generic
				set_variable = {
					BA_highlander_invest = 0
				}
				if = {
					limit = {
						tag = COU
					}
					add_to_variable = {
						BA_highlander_invest = 10
					}
				}
				if = {
					limit = {
						OR = {tag = RED tag = ARI}
					}
					set_country_flag = BA_nationalized_highlander
					remove_ideas = BA_highlander_academy_generic
				}
				if = {
					limit = {
						NOT = {
							OR = {
								tag = RED
								tag = ARI
							}
						}
					}
					activate_mission = BA_invest_highlander
				}
			}
			RE1 = { country_event = { id = RED_instability_system.3 days = 70 random_days = 25 } }
			RE2 = { country_event = { id = RED_instability_system.3 days = 70 random_days = 25 } }
			RE3 = { country_event = { id = RED_instability_system.3 days = 70 random_days = 25 } }
			#이벤트
			YUG = {
				set_cosmetic_tag = YUG_start_no_communism
			}
			HEU = {
				country_event = {
					id = HEU_event.0
				}
			}
            GEH = {
                if = {
                    limit = {
                        has_game_rule = {
                            rule = GEH_dress_Portrait_Rule
                            option = GEH_dress_Portrait_Rule_on
                        }
                    }
                    country_event = {
                        id = GEH_hidden_event.100
                    }
                }
            }
			RED = {
				country_event = {
					id = RED_event.5
					days = 32
					random_days = 27
				}
				country_event = {
					id = RED_minori_event.4
					days = 120
				}
			}
			FRA = {
				set_major = yes
				country_event = {
					id = FRA_prov_event.120
					days = 18
				}
				add_dynamic_modifier = {
					modifier = FRA_rising_support_for_repeated_fascism
				}
				activate_mission = FRA_rising_support_for_repeated_fascism_mission
			}
			SOV = {
				set_portraits = {
					character = SOV_nikita_khrushchyov
					army = {
						small = "GFX_idea_nikita_khrushchev"
						large = "GFX_portrait_SOV_nikita_khrushche"
					}
				}
			}
			FRM = {
				become_exiled_in = {
					target = FRA
					legitimacy = 5
				}
			}
			HYA = {
				country_event = {
					id = HYA_event.4
					days = 20
				}
			}
			SHA = {
			}
			# 스토리 아카이브 관련 코드
			BEL = {
				add_to_variable = {
					var = story_archive_national_array
					value = 1
				}
			}
			KSP = {
				add_to_variable = {
					var = story_archive_national_array
					value = 2
				}
			}
			TRM = {
				add_to_variable = {
					var = story_archive_national_array
					value = 3
				}
			}
			GEN = {
				add_to_variable = {
					story_archive_national_array = 4
				}
			}
			set_variable = {
				var = global.BA_resistance_n_var
				value = 1				#잠김
			}
			set_variable = {
				var = global.BA_resistance_w_var
				value = 2				#보통
			}
			set_variable = {
				var = global.BA_resistance_e_var
				value = 3				#레지스탕스
			}
			set_variable = {
				var = global.BA_resistance_se_var
				value = 2				#보통
			}
			set_variable = {
				var = global.BA_resistance_sw_var
				value = 3				#레지스탕스
			}
			every_country = {
				limit = {
					OR = {
						original_tag = RED
						original_tag = GEH
						original_tag = TRM
						original_tag = ARI
						original_tag = GEM
						original_tag = ABY
						original_tag = HYA
						original_tag = SHA
						original_tag = SHE
						original_tag = MIL
						original_tag = COU
						original_tag = KSP
						original_tag = SRT
						original_tag = HEU
					}
				}
				add_opinion_modifier = {
					target = JAP
					modifier = can_japanese
				}
				JAP = {
					add_opinion_modifier = {
						target = PREV
						modifier = can_japanese
					}
				}
			}
			#키보토스 / 지구 국가들 사이 안 좋게 만들기
			every_country = {
				limit = {
					Kivotos_tag = yes
				}
				every_country = {
					limit = {
						Kivotos_tag = no
					}
					add_opinion_modifier = {
						target = prev
						modifier = BA_another_demension
					}
					prev = {
						add_opinion_modifier = {
							target = prev
							modifier = BA_another_demension
						}
					}
				}
			}
		}
		effect = {
			4 = {
				set_state_flag = Megacity_State
				set_state_flag = Megacity_Shan_Haizing
			}
			8 = {
				set_state_flag = Megacity_State
				set_state_flag = Megacity_Problem_Solver_Office
			}
			9 = {
				set_state_flag = Megacity_State
				set_state_flag = Megacity_Hyakiyakyou
			}
			14 = {				
				set_state_flag = Megacity_State
				set_state_flag = Megacity_Baby_Rabbit_Park
			}
			34 = {
				set_state_flag = Megacity_State
				set_state_flag = Megacity_Valkyrie_Police_Center
			}
			52 = {
				set_state_flag = Megacity_State
				set_state_flag = Megacity_Prefect_Hall
			}
			64 = {
				set_state_flag = Megacity_State
				set_state_flag = Megacity_Eden
			}
			55 = {
				set_state_flag = Megacity_State
				set_state_flag = Megacity_GEH_Senter
			}
			85 = {
				set_state_flag = Megacity_State
				set_state_flag = Megacity_ARI_Vashilika
			}
			16 = {
				set_state_flag = Megacity_State
				set_state_flag = Megacity_MIL_Tower
			}
			35 = {
				set_state_flag = Megacity_State
				set_state_flag = Megacity_COU_Tower
			}
			141 = {
				set_state_flag = Megacity_State
				set_state_flag = Megacity_RED_Cherinograd
			}
			985 = {
				set_state_flag = Megacity_State
				set_state_flag = Megacity_ABY_High_School
			}
			every_country = {
				#군축조약 폐지
				limit = {
					has_naval_treaty_trigger = yes
				}
				remove_naval_treaty_effect = yes
				country_event = {
					id = MTG_naval_treaty.11
					hours = 6
				}
				remove_mission = MTG_treaty_renew_mission
			}
			ENG = {
				activate_advisor = edmund_ironside
			}
			USA = {
				diplomatic_relation = {
					country = CAN
					relation = guarantee
					active = no
				}
			}
		}
		effect = {
			if = {
				limit = {
					has_game_rule = {
						rule = kai_no_rule
						option = kai_no_rule_on
					}
				}
				ENG = {
					white_peace = KAI
					annex_country = {
						target = KAI
						transfer_troops = no
					}
				}
			}
		}
	}
	on_capitulation = {
		effect = {
			if = { #트리니티 붕괴 국가 항복시 자동으로 핵심 주 제거
				limit = {
					OR = {
						has_idea = BA_GER_defense
						has_idea = BA_GER_defense_week
					}
					has_war_with = TRM
					is_in_faction = no
				}
				every_core_state = {
					remove_core_of = ROOT
				}
			}
		}
	}
	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					FRA = {
						controls_state = 20
					}
				}
				FRA = {
					if = {
						limit = {
							NOT = {
								has_country_flag = FRA_prov_event.153_flag
							}
						}
						set_country_flag = FRA_prov_event.153_flag
						country_event = {
							id = FRA_prov_event.153
							days = 3
						}
					}
				}
				MIL = {
					if = {
						limit = {
							NOT = {
								has_country_flag = FRA_prov_event.153_flag
							}
						}
						set_country_flag = FRA_prov_event.153_flag
						country_event = {
							id = FRA_prov_event.153
							days = 3
						}
					}
				}
			}
			if = {
				limit = {
					FRA = {
						controls_state = 22
					}
				}
				FRA = {
					if = {
						limit = {
							NOT = {
								has_country_flag = FRA_prov_event.148_flag
							}
						}
						set_country_flag = FRA_prov_event.148_flag
						country_event = {
							id = FRA_prov_event.148
							days = 3
						}
					}
				}
				MIL = {
					if = {
						limit = {
							NOT = {
								has_country_flag = FRA_prov_event.148_flag
							}
						}
						set_country_flag = FRA_prov_event.148_flag
						country_event = {
							id = FRA_prov_event.148
							days = 3
						}
					}
				}
			}
			if = {
				limit = {
					FRA = {
						controls_state = 23
					}
				}
				FRA = {
					if = {
						limit = {
							NOT = {
								has_country_flag = FRA_prov_event.146_flag
							}
						}
						set_country_flag = FRA_prov_event.146_flag
						country_event = {
							id = FRA_prov_event.146
							days = 3
						}
					}
				}
				MIL = {
					if = {
						limit = {
							NOT = {
								has_country_flag = FRA_prov_event.146_flag
							}
						}
						set_country_flag = FRA_prov_event.146_flag
						country_event = {
							id = FRA_prov_event.146
							days = 3
						}
					}
				}
			}
			if = {
				limit = {
					KPD = {
						has_full_control_of_state = 58
					}
				}
				KPD = {
					country_event = {
						id = KPD_event.4
						days = 3
					}
				}
			}
			if = {
				limit = {
					KPD = {
						controls_state = 52
					}
				}
				KPD = {
					country_event = {
						id = KPD_event.5
						days = 3
					}
				}
			}
			if = {
				limit = {
					KPD = {
						controls_state = 763
					}
				}
				KPD = {
					country_event = {
						id = KPD_event.6
						days = 3
					}
				}
			}
			if = {
				limit = {
					KPD = {
						controls_state = 64
					}
				}
				KPD = {
					country_event = {
						id = KPD_event.3
						days = 3
					}
				}
			}
			if = {
				limit = {
					FRA = {
						has_full_control_of_state = 22
						has_war_with = MIL
						NOT = {
							has_completed_focus = FRA_focus_war_2
						}
					}
				}
				FRA = {
					complete_national_focus = FRA_focus_war_2
				}
			}
			if = {
				limit = {
					FRA = {
						has_full_control_of_state = 23
						has_war_with = MIL
						NOT = {
							has_completed_focus = FRA_focus_war_3
						}
					}
				}
				FRA = {
					complete_national_focus = FRA_focus_war_3
				}
			}
			if = {
				limit = {
					FRA = {
						has_full_control_of_state = 27
						has_war_with = MIL
						NOT = {
							has_completed_focus = FRA_focus_war_4
						}
					}
				}
				FRA = {
					complete_national_focus = FRA_focus_war_4
				}
			}
			if = {
				limit = {
					126 = {
						is_controlled_by = ENG
					}
				}
				set_province_name = {
					id = 6103
					name = "BA_London"
				}
				ENG = {
					set_capital = {
						state = 126
					}
				}
			}
			if = {
				limit = {
					SOV = {
						any_core_state = {
							is_owned_by = SOV
							is_controlled_by = TRM
						}
					}
				}
				set_country_flag = SOV_TRM_control
			}
			if = {
				limit = {
					335 = {
						is_controlled_by = INS
					}
				}
				INS = {
					set_capital = {
						state = 335
					}
				}
			}
			if = {
				limit = {
					FROM = {
						original_tag = TRM
						has_power_balance = {
							id = TRM_power_balance
						}
						is_power_balance_side_active = {
							id = TRM_power_balance
							side = TRM_SIS_side
						}
					}
					FROM.FROM = {
						is_owned_by = TRM
					}
				}
				if = {
					# 핵심주를 잃어버렸을때
					limit = {
						FROM.FROM = {
							is_core_of = TRM
						}
					}
					if = {
						# 처음 한번만 이벤트로 언급 됨
						limit = {
							FROM = {
								check_variable = {
									TRM_lost_core = 0
								}
							}
						}
						FROM = {
							set_variable = {
								TRM_lost_core = FROM.FROM
							}
							country_event = {
								id = TRM_event.101
								hours = 1
							}
						}
					}
					else = {
						# 다음번에는 그냥 잃어버림 아 ㅋㅋ
						add_power_balance_value = {
							id = TRM_power_balance
							value = 0.15
						}
					}
					#log = "-20% BoP due to losing core [FROM.FROM.GetName]"
				}
			}
			else_if = {
				# 트리니티가 핵심주를 되찾았을때
				limit = {
					ROOT = {
						original_tag = TRM
						has_power_balance = {
							id = TRM_power_balance
						}
						is_power_balance_side_active = {
							id = TRM_power_balance
							side = TRM_SIS_side
						}
					}
					FROM.FROM = {
						is_owned_by = TRM
					}
				}
				if = {
					limit = {
						FROM.FROM = {
							is_core_of = TRM
						}
					}
					if = {
						# 처음에는 알려줌
						limit = {
							check_variable = {
								TRM_reclaimed_core = 0
							}
						}
						# 오직 한번만
						set_variable = {
							TRM_reclaimed_core = FROM.FROM
						}
						country_event = {
							id = TRM_event.102
							hours = 1
						}
					}
					else = {
						add_power_balance_value = {
							id = TRM_power_balance
							value = -0.15
						}
						#log = "Reducing BoP modifier penalty due to getting back core [FROM.FROM.GetName]"
					}
				}
			}
		}
	}
	on_nuke_drop = {
		effect = {
			news_event = {
				id = BA_nuke.0
				days = 1
			}
		}
	}
	on_declare_war = {
		effect = {
			if = {
				limit = {
					has_country_flag = The_Colour_country_flag
				}
				every_country = {
					limit = {
						is_ally_with = FROM
					}
					add_to_war = {
						targeted_alliance = PREV
						enemy = ROOT
						hostility_reason = asked_to_join
					}
					country_event = {
						id = GEI_event.17
						hours = 6
					}
				}
			}
			if = {
				limit = {
					OR = {
						tag = GEM
						tag = GEH
					}
					FROM = {
						tag = GEA
					}
				}
				GEA = {
					load_oob = "BAY_event"
					set_popularities = {
						democratic = 0
						neutrality = 70
						fascism = 30
						communism = 0
					}
					set_politics = {
						ruling_party = neutrality
						elections_allowed = no
						last_election = "1936.1.1"
						election_frequency = 48
					}
				}
				GEN = {
					if = {
						limit = {
							exists = yes
							has_country_flag = GEN_communication_with_the_mainland_flag
						}
						country_event = {
							id = GEN_event.4
							days = 5
						}
					}
					else = {
						country_event = {
							id = GEN_event.4
							days = 25
						}
					}
				}
			}
			if = {
				limit = {
					FROM = {
						original_tag = SOV
						has_government = communism
					}
					ROOT = {
						original_tag = TRM
						has_completed_focus = TRN_GO_TO_EAST
						has_government = fascism
					}
				}
				news_event = {
					id = BA_news.8
					days = 2
				}
			}
			if = {
				limit = {
					ROOT = {
						OR = {
							tag = FRA
							tag = MIL
						}
					}
					FROM = {
						OR = {
							tag = FRA
							tag = MIL
						}
					}
				}
				MIL = {
					complete_national_focus = MIL_Game_2
				}
			}
		}
	}
}
